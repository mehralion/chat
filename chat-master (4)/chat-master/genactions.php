<?php

function ReturnActions() {
	include "config_ko.php";
	include "ny_events.php";

	if ((time()>$KO_start_time49) and (time()<$KO_fin_time49)) {
		$komlinks[$KO_A_ID49] = array(
			"img" => $KO_A_IMG49,
			"ico" => $KO_A_ICO49,						
			"title" => $KO_A_TITLE49,
			"text" => $KO_A_TXT49,
			"url" => $KO_A_URL49,
			"start" => $KO_start_time49,
			"end" => $KO_fin_time49,	
		);
	}

	if ((time()>$KO_start_time29) and (time()<$KO_fin_time29)) {
		$komlinks[$KO_A_ID29] = array(
			"img" => $KO_A_IMG29,
			"ico" => $KO_A_ICO29,						
			"title" => $KO_A_TITLE29,
			"text" => $KO_A_TXT29,
			"url" => $KO_A_URL29,
			"start" => $KO_start_time29,
			"end" => $KO_fin_time29,	
		);
	}

	if ((time()>$KO_start_time48) and (time()<$KO_fin_time48)) {
		$komlinks[$KO_A_ID48] = array(
			"img" => $KO_A_IMG48,
			"ico" => $KO_A_ICO48,						
			"title" => $KO_A_TITLE48,
			"text" => $KO_A_TXT48,
			"url" => $KO_A_URL48,
			"start" => $KO_start_time48,
			"end" => $KO_fin_time48,	
		);
	}

	if ((time()>$KO_start_time47) and (time()<$KO_fin_time47)) {
		$komlinks[$KO_A_ID47] = array(
			"img" => $KO_A_IMG47,
			"ico" => $KO_A_ICO47,						
			"title" => $KO_A_TITLE47,
			"text" => $KO_A_TXT47,
			"url" => $KO_A_URL47,
			"start" => $KO_start_time47,
			"end" => $KO_fin_time47,	
		);
	}

	if ((time()>$KO_start_time46) and (time()<$KO_fin_time46)) {
		$komlinks[$KO_A_ID46] = array(
			"img" => $KO_A_IMG46,
			"ico" => $KO_A_ICO46,						
			"title" => $KO_A_TITLE46,
			"text" => $KO_A_TXT46,
			"url" => $KO_A_URL46,
			"start" => $KO_start_time46,
			"end" => $KO_fin_time46,	
		);
	}

	if ((time()>$KO_start_time45) and (time()<$KO_fin_time45)) {
		$komlinks[$KO_A_ID45] = array(
			"img" => $KO_A_IMG45,
			"ico" => $KO_A_ICO45,						
			"title" => $KO_A_TITLE45,
			"text" => $KO_A_TXT45,
			"url" => $KO_A_URL45,
			"start" => $KO_start_time45,
			"end" => $KO_fin_time45,	
			"html" => $KO_A_HTML45,				
		);
	}


	if ((time()>$KO_start_time43) and (time()<$KO_fin_time43)) {
		$komlinks[$KO_A_ID43] = array(
			"img" => $KO_A_IMG43,
			"ico" => $KO_A_ICO43,						
			"title" => $KO_A_TITLE43,
			"text" => $KO_A_TXT43,
			"url" => $KO_A_URL43,
			"start" => $KO_start_time43,
			"end" => $KO_fin_time43,		
		);
	}


	if ((time()>$KO_start_time44) and (time()<$KO_fin_time44)) {
		$komlinks[$KO_A_ID44] = array(
			"img" => $KO_A_IMG44,
			"ico" => $KO_A_ICO44,						
			"title" => $KO_A_TITLE44,
			"text" => $KO_A_TXT44,
			"url" => $KO_A_URL44,
			"start" => $KO_start_time44,
			"end" => $KO_fin_time44,	
			"html" => $KO_A_HTML44,
		);
	}

	if ((time()>$KO_start_time42) and (time()<$KO_fin_time42)) {
		$komlinks[$KO_A_ID42] = array(
			"img" => $KO_A_IMG42,
			"ico" => $KO_A_ICO42,						
			"title" => $KO_A_TITLE42,
			"text" => $KO_A_TXT42,
			"url" => $KO_A_URL42,
			"start" => $KO_start_time42,
			"end" => $KO_fin_time42,		
		);
	}


	if ((time()>$KO_start_time25) and (time()<$KO_fin_time25)) {
		$komlinks[$KO_A_ID25] = array(
			"img" => $KO_A_IMG25,
			"ico" => $KO_A_ICO25,						
			"title" => $KO_A_TITLE25,
			"text" => $KO_A_TXT25,
			"url" => $KO_A_URL25,
			"start" => $KO_start_time25,
			"end" => $KO_fin_time25,		
			"html" => $KO_A_HTML25,						
		);
	}


	if ((time()>$KO_start_time39) and (time()<$KO_fin_time39)) {
		$komlinks[$KO_A_ID39] = array(
			"img" => $KO_A_IMG39,
			"ico" => $KO_A_ICO39,						
			"title" => $KO_A_TITLE39,
			"text" => $KO_A_TXT39,
			"url" => $KO_A_URL39,			
			"start" => $KO_start_time39,
			"end" => $KO_fin_time39,			
		);
	}

	if ((time()>$KO_start_time38) and (time()<$KO_fin_time38)) {
		$komlinks[$KO_A_ID38] = array(
			"img" => $KO_A_IMG38,
			"ico" => $KO_A_ICO38,						
			"title" => $KO_A_TITLE38,
			"text" => $KO_A_TXT38,
			"url" => $KO_A_URL38,			
			"start" => $KO_start_time38,
			"end" => $KO_fin_time38,			
			"html" => $KO_A_HTML38,									
		);
	}

	if ((time()>$KO_start_time37) and (time()<$KO_fin_time37)) {
		$komlinks[$KO_A_ID37] = array(
			"img" => $KO_A_IMG37,
			"ico" => $KO_A_ICO37,						
			"title" => $KO_A_TITLE37,
			"text" => $KO_A_TXT37,
			"url" => $KO_A_URL37,			
			"start" => $KO_start_time37,
			"end" => $KO_fin_time37,			
			"html" => $KO_A_HTML37,									
		);
	}

	if ((time()>$KO_start_time40) and (time()<$KO_fin_time40)) {
		$komlinks[$KO_A_ID40] = array(
			"img" => $KO_A_IMG40,
			"ico" => $KO_A_ICO40,						
			"title" => $KO_A_TITLE40,
			"text" => $KO_A_TXT40,
			"url" => $KO_A_URL40,			
			"start" => $KO_start_time40,
			"end" => $KO_fin_time40,			
			"html" => $KO_A_HTML40,									
		);
	}

	if ((time()>$KO_start_time36) and (time()<$KO_fin_time36)) {
		$komlinks[$KO_A_ID36] = array(
			"img" => $KO_A_IMG36,
			"ico" => $KO_A_ICO36,						
			"title" => $KO_A_TITLE36,
			"text" => $KO_A_TXT36,
			"url" => $KO_A_URL36,			
			"start" => $KO_start_time36,
			"end" => $KO_fin_time36,			
			"html" => $KO_A_HTML36,									
		);
	}

	if ((time()>$KO_start_time30) and (time()<$KO_fin_time30)) {
		$komlinks[$KO_A_ID30] = array(
			"img" => $KO_A_IMG30,
			"ico" => $KO_A_ICO30,						
			"title" => $KO_A_TITLE30,
			"text" => $KO_A_TXT30,
			"url" => $KO_A_URL30,			
			"start" => $KO_start_time30,
			"end" => $KO_fin_time30,			
		);
	}

	if ((time()>$KO_start_time26) and (time()<$KO_fin_time26)) {
		$komlinks[$KO_A_ID26] = array(
			"img" => $KO_A_IMG26,
			"ico" => $KO_A_ICO26,						
			"title" => $KO_A_TITLE26,
			"text" => $KO_A_TXT26,
			"url" => $KO_A_URL26,			
			"start" => $KO_start_time26,
			"end" => $KO_fin_time26,	
		
					
		);
	}

	if ((time()>$KO_start_time7) and (time()<$KO_fin_time7)) {
		$komlinks[$KO_A_ID7] = array(
			"title" => $KO_A_TITLE7,
			"text" => $KO_A_TXT7,
			"ico" => $KO_A_ICO7,			
			"url" => $KO_A_URL7,
			"start" => $KO_start_time7,			
			"end" => $KO_fin_time7,
			"button_url" => $KO_A_BUTTON7,
			"button_title" => $KO_A_BUTTON_TITLE7,			
			
		);
	}	

	if ((time()>$KO_start_time31) and (time()<$KO_fin_time31)) {
		$komlinks[$KO_A_ID31] = array(
			"img" => $KO_A_IMG31,
			"title" => $KO_A_TITLE31,
			"text" => $KO_A_TXT31,
			"url" => $KO_A_URL31,
			"ico" => $KO_A_ICO31,	
			"start" => $KO_start_time31,			
			"end" => $KO_fin_time31,					
			"html" => $KO_A_HTML31,						
			
		);
	}
	
	
	if ((time()>$KO_start_time32) and (time()<$KO_fin_time32)) {
		$komlinks[$KO_A_ID32] = array(
			"img" => $KO_A_IMG32,
			"title" => $KO_A_TITLE32,
			"text" => $KO_A_TXT32,
			"url" => $KO_A_URL32,
			"ico" => $KO_A_ICO32,	
			"start" => $KO_start_time32,			
			"end" => $KO_fin_time32,					
			"html" => $KO_A_HTML32,						
			
		);
	}	

	if ((time()>$KO_start_time22) and (time()<$KO_fin_time22)) {
		$komlinks[$KO_A_ID22] = array(
			"img" => $KO_A_IMG22,
			"title" => $KO_A_TITLE22,
			"text" => $KO_A_TXT22,
			"url" => $KO_A_URL22,
			"ico" => $KO_A_ICO22,	
			"start" => $KO_start_time22,			
			"end" => $KO_fin_time22,					
			"html" => $KO_A_HTML22,						
			
		);
	}

	if ((time()>$KO_start_time28) and (time()<$KO_fin_time28)) {
		$komlinks[$KO_A_ID28] = array(
			"img" => $KO_A_IMG28,
			"ico" => $KO_A_ICO28,		
			"url" => $KO_A_URL28,							
			"title" => $KO_A_TITLE28,
			"text" => $KO_A_TXT28,
			"start" => $KO_start_time28,
			"end" => $KO_fin_time28,
			"html" => $KO_A_HTML28,
		);
	}
	
	
	if ((time()>$KO_start_time23) and (time()<$KO_fin_time23)) {
		$komlinks[$KO_A_ID23] = array(
			"img" => $KO_A_IMG23,
			"ico" => $KO_A_ICO23,						
			"title" => $KO_A_TITLE23,
			"text" => $KO_A_TXT23,
			"url" => $KO_A_URL23,
			"start" => $KO_start_time23,
			"end" => $KO_fin_time23,			
			
		);
	}
	
	if ((time()>$KO_start_time21) and (time()<$KO_fin_time21)) {
		$komlinks[$KO_A_ID21] = array(
			"img" => $KO_A_IMG21,
			"ico" => $KO_A_ICO21,			
			"title" => $KO_A_TITLE21,
			"text" => $KO_A_TXT21,
			"url" => $KO_A_URL21,
		);
	}

	if ((time()>$KO_start_time55) and (time()<$KO_fin_time55)) 
	{

		$komlinks[$KO_A_ID55] = array(
			"img" => $KO_A_IMG55,
			"ico" => $KO_A_ICO55,			
			"title" => $KO_A_TITLE55,
			"text" => $KO_A_TXT55,
			"url" => $KO_A_URL55,
			"start" => $KO_start_time55,
			"end" => $KO_fin_time55,			
			
		);
	}


	if ((time()>$KO_start_time8-14400) and (time()<$KO_fin_time8-14400)) {
		
		$komlinks[$KO_A_ID8]=array(
			"title" => $KO_A_TITLE8,
			"text" => $KO_A_TXT8,
			"url" => $KO_A_URL8,
			"start" => $KO_start_time8-14400,
			"end" => $KO_fin_time8-14400,
		);
	}


	if ((time()>$ny_events['skupkastart']) and (time()<$ny_events['skupkaend'])) {
		// скупка
		$komlinks[$KO_A_ID16] =  array(
			"title" => $KO_A_TITLE16,
			"text" => $KO_A_TXT16,
			"url" => $KO_A_URL16,
			"start" => $ny_events['skupkastart'],
			"end" => $ny_events['skupkaend'],
		);
						
	}


	if ((time()>$KO_start_time) and (time()<$KO_fin_time)) {
		
		$komlinks[$KO_A_ID]=array(
			"title" => $KO_A_TITLE,
			"text" => $KO_A_TXT,
			"url" => $KO_A_URL,
			"start" => $KO_start_time,
			"end" => $KO_fin_time,
			"ico" => $KO_A_ICO,		
			"button_url" => $KO_A_BUTTON,
			"button_title" => $KO_A_BUTTON_TITLE,			

				
		);
	}

					

	if ((time()>$KO_start_time17-14400) and (time()<$KO_fin_time17-14400)) {
		
		$komlinks[$KO_A_ID17] = array(
			"title" => $KO_A_TITLE17,
			"text" => $KO_A_TXT17,
			"url" => $KO_A_URL17,
			"start" => $KO_start_time17-14400,			
			"end" => $KO_fin_time17-14400,
		);
	}

	if ((time()>$KO_start_time18) and (time()<$KO_fin_time18)) {
		
		$komlinks[$KO_A_ID18] = array(
			"title" => $KO_A_TITLE18,
			"text" => $KO_A_TXT18,
			"url" => $KO_A_URL18,
			"ico" => $KO_A_ICO18,		
			"start" => $KO_start_time18,			
			"end" => $KO_fin_time18,
		);
	}

	if ((time()>$KO_start_time19) and (time()<$KO_fin_time19)) {
		
		$komlinks[$KO_A_ID19] = array(
			"title" => $KO_A_TITLE19,
			"ico" => $KO_A_ICO19,			
			"text" => $KO_A_TXT19,
			"url" => $KO_A_URL19,
			"start" => $KO_start_time19,			
			"end" => $KO_fin_time19,
		);
	}

/*
	if ((time()>$KO_start_time20) and (time()<$KO_fin_time20)) {
		$komlinks[$KO_A_ID20] = array(
			"title" => $KO_A_TITLE20,
			"text" => $KO_A_TXT20,
			"url" => $KO_A_URL20,
			"start" => $KO_start_time20,			
			"end" => $KO_fin_time20,
		);
	}
*/						
	if(time()>$KO_BOX_start_time && time()<$KO_BOX_fin_time) {
		//покупка ларцов и яиц
		$komlinks[$KO_BOX_EGGS_ID]=array(
			"title" => $KO_BOX_EGGS_TITLE,
			"ico" => $KO_BOX_EGGS_ICO,			
			"text" => $KO_BOX_EGGS_TXT,
			"url" => $KO_BOX_EGGS_URL,
			"start" => $KO_BOX_start_time,			
			"end" => $KO_BOX_fin_time,
		);
	}
						

	if(time()>$KO_start_time2 && time()<$KO_fin_time2) {
		//образы и картинки
		$komlinks[$KO_A_ID2]=array(
			"title" => $KO_A_TITLE2,
			"ico" => $KO_A_ICO2,			
			"text" => $KO_A_TXT2,
			"url" => $KO_A_URL2,
			"start" => $KO_start_time2,			
			"end" => $KO_fin_time2,
			"html" => $KO_A_HTML2,			
		);
	}

	if(time()>$KO_start_time33 && time()<$KO_fin_time33) {
		$komlinks[$KO_A_ID33]=array(
			"title" => $KO_A_TITLE33,
			"ico" => $KO_A_ICO33,			
			"text" => $KO_A_TXT33,
			"url" => $KO_A_URL33,
			"start" => $KO_start_time33,			
			"end" => $KO_fin_time33,
			"html" => $KO_A_HTML33,			
		);
	}
	

	if(time()>$KO_start_time41 && time()<$KO_fin_time41) {
		$komlinks[$KO_A_ID41]=array(
			"title" => $KO_A_TITLE41,
			"ico" => $KO_A_ICO41,			
			"text" => $KO_A_TXT41,
			"url" => $KO_A_URL41,
			"start" => $KO_start_time41,			
			"end" => $KO_fin_time41,
		);
	}	

/*						
	if(time()>$KO_start_time3 && time()<$KO_fin_time3) {
		//лето
		$komlinks[$KO_A_ID3]=array(
			"title" => $KO_A_TITLE3,
			"text" => $KO_A_TXT3,
			"url" => $KO_A_URL3,
			"start" => $KO_start_time3,			
			"end" => $KO_fin_time3,
		);
	} elseif(time()>$KO_start_time4 && time()<$KO_fin_time4) {
		//зима
		$komlinks[$KO_A_ID4]=array(
			"title" => $KO_A_TITLE4,
			"ico" => $KO_A_ICO4,			
			"text" => $KO_A_TXT4,
			"url" => $KO_A_URL4,
			"start" => $KO_start_time4,			
			"end" => $KO_fin_time4,
		);
	} 
	elseif(time()>$KO_start_time5 && time()<$KO_fin_time5) {
		//весна
		$komlinks[$KO_A_ID5]=array(
			"title" => $KO_A_TITLE5,
			"text" => $KO_A_TXT5,
			"url" => $KO_A_URL5,
			"start" => $KO_start_time5,			
			"end" => $KO_fin_time5,
			
		);
	}
	*/

	if (isset($KO_A_ID13)) {
		if (!isset($KO_A_URL13)) $KO_A_URL13 = "";
		$komlinks[$KO_A_ID13] =  array(
			"title" => $KO_A_TITLE13,
			"ico" => $KO_A_ICO13,			
			"text" => $KO_A_TXT13,
			"url" => $KO_A_URL13,
			"button_url" => $KO_A_BUTTON13,
			"button_title" => $KO_A_BUTTON_TITLE13,			
			"end" => "",
			
		);
	}

	if (isset($KO_A_ID52)) {
		if(time()>$KO_start_time52 && time()<$KO_fin_time52) {
			if (!isset($KO_A_URL52)) $KO_A_URL52 = "";
			$komlinks[$KO_A_ID52] =  array(
				"title" => $KO_A_TITLE52,
				"ico" => $KO_A_ICO52,			
				"text" => $KO_A_TXT52,
				"url" => $KO_A_URL52,
				"end" => $KO_fin_time52,
				
			);
		}
	}

	if (isset($KO_A_ID53)) {
		if(time()>$KO_start_time53 && time()<$KO_fin_time53) {
			if (!isset($KO_A_URL53)) $KO_A_URL53 = "";
			$komlinks[$KO_A_ID53] =  array(
				"title" => $KO_A_TITLE53,
				"ico" => $KO_A_ICO53,
				"text" => $KO_A_TXT53,
				"url" => $KO_A_URL53,
				"end" => $KO_fin_time53,

			);
		}
	}


	if (isset($KO_A_ID56)) {
		if(time()>$KO_start_time56 && time()<$KO_fin_time56) {
			if (!isset($KO_A_URL56)) $KO_A_URL56 = "";
			$komlinks[$KO_A_ID56] =  array(
				"title" => $KO_A_TITLE56,
				"ico" => $KO_A_ICO56,			
				"text" => $KO_A_TXT56,
				"url" => $KO_A_URL56,
				"end" => $KO_fin_time56,
				
			);
		}
	}

			
	if(time()>$start_volna && time()<$end_volna) {
		//образы и картинки
		$komlinks[$VOLNA_ID] = array(
			"title" => $VOLNA_TITLE,
			"text" => $VOLNA_TXT,
			"url" => $VOLNA_URL,
			"start" => $start_volna,			
			"end" => $end_volna,
			"ico" => $VOLNA_ICO,
		);
	}

	//надо добавлять картинки на всякие волны хаоса
	if (time() > $ny_events['elkadropstart'] && time() < $ny_events['elkadropend']) {
		$komlinks[$KO_A_ID14] =  array(
			"title" => $KO_A_TITLE14,
			"ico" => $KO_A_ICO14,			
			"text" => $KO_A_TXT14,
			"url" => $KO_A_URL14,
			"start" => $ny_events['elkadropstart'],			
			"end" => $ny_events['elkadropend'],
		);
	}

	if (time() > $ny_events['elkacpeatstart'] && time() < $ny_events['elkacpeatend']) {
		$komlinks[$KO_A_ID15] =  array(
			"title" => $KO_A_TITLE15,
			"text" => $KO_A_TXT15,
			"url" => "",
			"start" => $ny_events['elkacpeatstart'],			
			"end" => $ny_events['elkacpeatend'],
		);
	}



	return order_actions($komlinks);
}

function order_actions($arr)
{
$arr_out=array();
$arr_ok=array();
$nr=0;
	foreach($arr as $k => $vline) 
		{
			foreach($vline as $nazv=> $val) 		
				{
					if ($nazv=='end')			
						{
						$nr+=2; // +1 секунда для избежания пропаданий акций с одинаковым окончанием
						if ($val=='') $val=time();
							$arr_out[$val+$nr]=$vline;
							$arr_out[$val+$nr]['id']=$k;								
						}
				}
		}
ksort($arr_out); //сортируем

//возвращаем ид на место
	foreach($arr_out as $k => $vline) 
		{
			foreach($vline as $nazv=> $val) 		
				{
					if ($nazv=='id')			
						{
							$arr_ok[$val]=$vline;
						}
				}
		}

return $arr_ok;
}
/*
$input=ReturnActions();
echo "<pre>";
print_r($input);
echo "</pre><br>";

$input2=order_actions($input);
echo "<pre>";
print_r($input2);
echo "</pre>";
*/


?>